lazy_init_models: true
train_fraction: 0.95
batch_size: 128
num_workers: 32
window_size: 10
num_training_epochs: 1
data_parallel: false
device: cuda
optim: Adam
save_latents: false
lr: 0.0001
weight_decay: 0.1
betas:
- 0.9
- 0.95
grad_norm_clip: 1.0
seed: 42
num_prior_epochs: 40
eval_prior_every: 1
save_prior_every: 1
eval_every: 1
save_every: 1
project: behavior_transformer_test
experiment: bridge_data
encoder:
  _target_: models.resnet.resnet34
  pretrained: true
  freeze_pretrained: true
  output_dim: 512
  reproject_dim: 519
action_ae:
  _target_: models.action_ae.discretizers.k_means.KMeansDiscretizer
  num_bins: 64
  action_dim: ${env.action_dim}
  device: ${device}
  predict_offsets: true
env:
  name: bridge-dummmy-v0
  args: []
  kwargs: {}
  obs_dim: 512
  action_dim: 7
  action_min:
  - -1
  - -1
  action_max:
  - 1
  - 1
  load_dir: /absolute/path/to/training_run/directory
  workspace:
    _target_: workspaces.bridge_kitchen.BridgeRepWorkspace
  dataset_fn:
    _target_: dataloaders.trajectory_loader.get_bridge_dataset
    data_directory: ${env_vars.datasets.carla_multipath_town04_merge}
    window_size: ${window_size}
    subset_fraction: 1.0
    encoder:
      _target_: models.resnet.resnet18
      output_dim: 512
      pretrained: true
      freeze_pretrained: true
state_prior:
  _target_: models.latent_generators.mingpt.MinGPT
  discrete_input: false
  input_dim: ${encoder.output_dim}
  vocab_size: ???
  n_layer: 3
  n_head: 4
  n_embd: 256
  attn_pdrop: 0.6
  resid_pdrop: 0.6
  embd_pdrop: 0.6
  block_size: ${window_size}
  predict_offsets: true
  offset_loss_scale: 500.0
  focal_loss_gamma: 2.0
  action_dim: ${env.action_dim}
env_vars:
  datasets:
    carla_multipath_town04_merge: /path/to/datasets/carla_dataset
    relay_kitchen: /path/to/datasets/relay_kitchen_dataset
    multimodal_push_fixed_target: /path/to/datasets/block_push_dataset
