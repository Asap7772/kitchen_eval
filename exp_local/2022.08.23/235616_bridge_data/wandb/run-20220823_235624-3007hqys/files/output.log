K-means clustering: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:00<00:00, 160.30it/s]
Training prior: :   0%|                                                                                                                                          | 0/40 [00:00<?, ?it/s]
Training prior epoch 0:   0%|                                                                                                                                     | 0/8 [00:00<?, ?it/s]
done step 1/50, re-initialized 8 dead clusters
Training prior: :   0%|                                                                                                                                          | 0/40 [00:03<?, ?it/s]
Error executing job with overrides: []
Traceback (most recent call last):
  File "train.py", line 291, in main
    workspace.run()
  File "train.py", line 190, in run
    self.train_prior()
  File "train.py", line 132, in train_prior
    _, loss, loss_components = self.state_prior.get_latent_and_loss(
  File "/nfs/kun2/users/asap7772/bet/models/latent_generators/mingpt.py", line 98, in get_latent_and_loss
    output, _ = self.model(obs_rep)
  File "/home/asap7772/miniconda3/envs/behavior-transformer/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/nfs/kun2/users/asap7772/bet/models/libraries/mingpt/model.py", line 236, in forward
    token_embeddings = self.tok_emb(idx)  # each index maps to a (learnable) vector
  File "/home/asap7772/miniconda3/envs/behavior-transformer/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/asap7772/miniconda3/envs/behavior-transformer/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 103, in forward
    return F.linear(input, self.weight, self.bias)
  File "/home/asap7772/miniconda3/envs/behavior-transformer/lib/python3.8/site-packages/torch/nn/functional.py", line 1848, in linear
    return torch._C._nn.linear(input, weight, bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1280x519 and 512x256)
Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.