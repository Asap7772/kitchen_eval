done step 1/50, re-initialized 8 dead clusters
[2022-08-23 21:35:08,398][models.libraries.mingpt.model][INFO] - number of parameters: 2.634752e+06
K-means clustering: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:00<00:00, 279.08it/s]
Training prior: :   0%|                                                                                                                                                                                                                                                                        | 0/40 [00:00<?, ?it/s]
Training prior: :   0%|                                                                                                                                                                                                                                                                        | 0/40 [00:03<?, ?it/s]
Error executing job with overrides: []
Traceback (most recent call last):
  File "train.py", line 284, in main
    workspace.run()
  File "train.py", line 183, in run
    self.train_prior()
  File "train.py", line 126, in train_prior
    enc_obs = self.obs_encoding_net(obs)
  File "/home/asap7772/miniconda3/envs/behavior-transformer/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/nfs/kun2/users/asap7772/bet/models/resnet.py", line 28, in forward
    assert x.dim() >=4, f"input must be at least 4D {x}, {x.shape}"
AssertionError: input must be at least 4D tensor([[[4.3974e+01, 8.7525e+00, 2.0809e-02,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [4.4563e+01, 8.6347e+00, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [4.4504e+01, 9.2477e+00, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         ...,
         [4.3254e+01, 8.9804e+00, 3.9157e-01,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [4.4218e+01, 9.1726e+00, 5.1790e-01,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [4.4604e+01, 1.0639e+01, 4.7301e-01,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00]],
        [[4.8223e+01, 9.8278e+00, 2.4346e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [4.7254e+01, 8.6872e+00, 1.8629e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [4.6422e+01, 8.2206e+00, 1.3664e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         ...,
         [4.5343e+01, 9.3239e+00, 4.7278e-01,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [4.6063e+01, 1.1217e+01, 4.7215e-01,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [4.6377e+01, 1.0393e+01, 2.9194e-01,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00]],
        [[4.4765e+01, 1.2186e+01, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [4.3602e+01, 1.1416e+01, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [4.5009e+01, 9.8334e+00, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         ...,
         [5.1256e+01, 1.3512e+01, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [5.2498e+01, 1.3327e+01, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [5.1832e+01, 1.3546e+01, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00]],
        ...,
        [[3.9364e+01, 9.5779e+00, 7.0128e-01,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [3.8226e+01, 1.8534e+01, 1.8143e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [4.0069e+01, 1.4834e+01, 2.0338e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         ...,
         [4.8362e+01, 1.2707e+01, 1.9303e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [4.9875e+01, 1.2840e+01, 2.1312e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [4.9433e+01, 1.2236e+01, 2.0524e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00]],
        [[4.3178e+01, 9.6829e+00, 2.2054e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [4.2453e+01, 8.7833e+00, 2.2269e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [4.6084e+01, 8.9308e+00, 2.5123e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         ...,
         [3.7846e+01, 1.1338e+01, 8.6250e-01,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [4.0976e+01, 7.0394e+00, 2.3999e-01,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [4.3821e+01, 8.8699e+00, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00]],
        [[6.0125e+01, 2.6404e+01, 7.8758e-01,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [5.4080e+01, 3.3262e+01, 9.6184e-02,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [5.4975e+01, 2.7335e+01, 3.6657e-01,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         ...,
         [5.1181e+01, 1.1581e+01, 9.6605e-02,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [5.4196e+01, 1.0975e+01, 2.4794e-01,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [5.1072e+01, 9.2338e+00, 5.9371e-01,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00]]], device='cuda:0'), torch.Size([128, 10, 512])
Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.