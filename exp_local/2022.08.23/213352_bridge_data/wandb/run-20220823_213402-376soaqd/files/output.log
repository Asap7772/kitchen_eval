done step 1/50, re-initialized 8 dead clusters
[2022-08-23 21:34:11,034][models.libraries.mingpt.model][INFO] - number of parameters: 2.634752e+06
K-means clustering: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:00<00:00, 130.83it/s]
Training prior: :   0%|                                                                                                                                                                                                                                                                        | 0/40 [00:00<?, ?it/s]
Training prior: :   0%|                                                                                                                                                                                                                                                                        | 0/40 [00:21<?, ?it/s]
Error executing job with overrides: []
Traceback (most recent call last):
  File "train.py", line 284, in main
    workspace.run()
  File "train.py", line 183, in run
    self.train_prior()
  File "train.py", line 126, in train_prior
    enc_obs = self.obs_encoding_net(obs)
  File "/home/asap7772/miniconda3/envs/behavior-transformer/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/asap7772/miniconda3/envs/behavior-transformer/lib/python3.8/site-packages/torch/nn/parallel/data_parallel.py", line 158, in forward
    inputs, kwargs = self.scatter(inputs, kwargs, self.device_ids)
  File "/home/asap7772/miniconda3/envs/behavior-transformer/lib/python3.8/site-packages/torch/nn/parallel/data_parallel.py", line 175, in scatter
    return scatter_kwargs(inputs, kwargs, device_ids, dim=self.dim)
  File "/home/asap7772/miniconda3/envs/behavior-transformer/lib/python3.8/site-packages/torch/nn/parallel/scatter_gather.py", line 44, in scatter_kwargs
    inputs = scatter(inputs, target_gpus, dim) if inputs else []
  File "/home/asap7772/miniconda3/envs/behavior-transformer/lib/python3.8/site-packages/torch/nn/parallel/scatter_gather.py", line 36, in scatter
    res = scatter_map(inputs)
  File "/home/asap7772/miniconda3/envs/behavior-transformer/lib/python3.8/site-packages/torch/nn/parallel/scatter_gather.py", line 23, in scatter_map
    return list(zip(*map(scatter_map, obj)))
  File "/home/asap7772/miniconda3/envs/behavior-transformer/lib/python3.8/site-packages/torch/nn/parallel/scatter_gather.py", line 19, in scatter_map
    return Scatter.apply(target_gpus, None, dim, obj)
  File "/home/asap7772/miniconda3/envs/behavior-transformer/lib/python3.8/site-packages/torch/nn/parallel/_functions.py", line 96, in forward
    outputs = comm.scatter(input, target_gpus, chunk_sizes, ctx.dim, streams)
  File "/home/asap7772/miniconda3/envs/behavior-transformer/lib/python3.8/site-packages/torch/nn/parallel/comm.py", line 189, in scatter
    return tuple(torch._C._scatter(tensor, devices, chunk_sizes, dim, streams))
RuntimeError: CUDA error: out of memory
CUDA kernel errors might be asynchronously reported at some other API call,so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.